<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta name="viewport" content="initial-scale=1.0" charset="utf-8" />
        <title>Mobile Demo</title>

        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
        <script>
            var _apiKey = 'kill-9';
            var _contacts = null;

            //gets the contact list from the server
            function getContacts(cb) {
                $.get(
                    'http://contacts.tinyapollo.com/contacts?key=' + _apiKey,
                    function(data) {
                        _contacts = data.contacts;
                        cb();
                    }
                )
            }

            //home page before show
            $(document).on("pagebeforeshow", "#home-page", function() {
                var contactList = $('#contact-list');
                contactList.html('');
                getContacts(function() {
                    for (var i in _contacts) {
                        var contact = _contacts[i];
                        contactList.append('<li><a href="#">' + contact.name + '</a></li>');
                    }
                    contactList.listview('refresh');
                })
            })
        </script>
        <link rel="stylesheet" type="text/css" href="ContactViewer.css" />
    </head>
    <body>
        <div data-role="page" id="home-page">
            <div data-role="header">
                <h1>My Demo</h1>
            </div>
            <div data-role="content">
                <ul data-role="listview" id="contact-list">
                </ul>
            </div>
        </div>
    </body>
</html>
